<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Gin Bottle Label Creator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@400;700&family=Lato:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Merriweather:wght@400;700&family=Marcellus:wght@400;700&family=EB+Garamond:wght@400;700&family=Prata&family=Cormorant+Garamond:wght@400;700&family=Italiana&family=Cinzel:wght@400;700&family=Dancing+Script:wght@400;700&family=Gloock&family=Great+Vibes&family=Libre+Baskerville:wght@400;700&family=Parisienne&family=Old+Standard+TT&family=Euphoria+Script&family=Uncial+Antiqua&family=Tangerine:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
    <h1>Custom Gin Bottle Label Creator</h1>
    
    <div class="container">
        <div class="controls">
            <div class="control-group">
                <label for="brandName">Brand / Gin Type:</label>
                <input type="text" id="brandName" value="ARTISANAL LONDON DRY">
                <div class="slider-container">
                    <label for="brandNameSize">Font Size:</label>
                    <input type="range" id="brandNameSize" min="0" max="100" value="24">
                    <span id="brandNameSizeValue" class="slider-value">24px</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="ginName">Gin Name:</label>
                <input type="text" id="ginName" value="JUNIPER BOTANIST">
                <div class="slider-container">
                    <label for="ginNameSize">Font Size:</label>
                    <input type="range" id="ginNameSize" min="0" max="100" value="36">
                    <span id="ginNameSizeValue" class="slider-value">36px</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="ingredients">Ingredients:</label>
                <textarea id="ingredients">Handcrafted with juniper berries, coriander seed, angelica root, orris root, licorice, cassia bark, and a hint of citrus</textarea>
                <div class="slider-container">
                    <label for="ingredientsSize">Font Size:</label>
                    <input type="range" id="ingredientsSize" min="0" max="100" value="12">
                    <span id="ingredientsSizeValue" class="slider-value">12px</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="alcoholContent">Alcohol Content:</label>
                <input type="text" id="alcoholContent" value="43.5% ABV">
                <div class="slider-container">
                    <label for="alcoholContentSize">Font Size:</label>
                    <input type="range" id="alcoholContentSize" min="0" max="100" value="14">
                    <span id="alcoholContentSizeValue" class="slider-value">14px</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="amount">Amount:</label>
                <input type="text" id="amount" value="750ml / 25.4 fl oz">
                <div class="slider-container">
                    <label for="amountSize">Font Size:</label>
                    <input type="range" id="amountSize" min="0" max="100" value="14">
                    <span id="amountSizeValue" class="slider-value">14px</span>
                </div>
            </div>
            
            <div class="control-group">
                <div class="slider-container">
                    <label for="decorationLevel">Decoration Level:</label>
                    <input type="range" id="decorationLevel" min="0" max="10" value="5">
                    <span id="decorationLevelValue" class="slider-value">5</span>
                </div>
            </div>
            
            <div class="control-group">
                <div class="slider-container">
                    <label for="padding">Padding (px):</label>
                    <input type="range" id="padding" min="10" max="100" value="40">
                    <span id="paddingValue" class="slider-value">40px</span>
                </div>
            </div>
            
            <div class="control-group">
                <div class="toggle-container">
                    <label for="blackAndWhite">Black & White Only:</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="blackAndWhite" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div id="colorControls" style="display: none;">
                    <div class="color-control">
                        <label for="backgroundColor">Background Color:</label>
                        <input type="color" id="backgroundColor" value="#F6F0ED">
                    </div>
                    
                    <div class="color-control">
                        <label for="primaryColor">Primary Color:</label>
                        <input type="color" id="primaryColor" value="#28536B">
                    </div>
                    
                    <div class="color-control">
                        <label for="secondaryColor">Secondary Color:</label>
                        <input type="color" id="secondaryColor" value="#7EA8BE">
                    </div>
                </div>
            </div>
            
            <div class="control-group">
                <button id="saveButton">Download Label</button>
                <button id="clearButton">Reset All</button>
            </div>
        </div>
        
        <div class="preview-container">
            <div class="label-preview">
                <div class="label dec-level-5">
                    <div class="inner-border decoration"></div>
                    <div class="double-border decoration"></div>
                    <div class="triple-border decoration"></div>
                    
                    <div class="corner corner-tl decoration">
                        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2 2C2 10 10 10 18 2" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M2 6C2 12 8 12 14 6" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M6 2C12 2 12 8 6 14" stroke="currentColor" fill="none" stroke-width="1" />
                        </svg>
                    </div>
                    <div class="corner corner-tr decoration">
                        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 2C10 2 10 10 18 18" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M14 2C8 2 8 8 14 14" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M18 6C12 6 12 12 6 12" stroke="currentColor" fill="none" stroke-width="1" />
                        </svg>
                    </div>
                    <div class="corner corner-bl decoration">
                        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2 18C10 18 10 10 2 2" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M6 18C12 18 12 12 6 6" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M2 14C8 14 8 8 14 8" stroke="currentColor" fill="none" stroke-width="1" />
                        </svg>
                    </div>
                    <div class="corner corner-br decoration">
                        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 18C10 18 10 10 18 2" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M14 18C8 18 8 12 14 6" stroke="currentColor" fill="none" stroke-width="1" />
                            <path d="M18 14C12 14 12 8 6 8" stroke="currentColor" fill="none" stroke-width="1" />
                        </svg>
                    </div>
                    
                    <div class="squiggle-top decoration">
                        <svg width="100" height="10" viewBox="0 0 100 10" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0 5C10 0 15 10 25 5C35 0 40 10 50 5C60 0 65 10 75 5C85 0 90 10 100 5" stroke="currentColor" fill="none" />
                        </svg>
                    </div>
                    <div class="squiggle-bottom decoration">
                        <svg width="100" height="10" viewBox="0 0 100 10" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0 5C10 0 15 10 25 5C35 0 40 10 50 5C60 0 65 10 75 5C85 0 90 10 100 5" stroke="currentColor" fill="none" />
                        </svg>
                    </div>
                    
                    <div class="label-content">
                        <div class="brand-name"></div>
                        <div class="flourish decoration">
                            <svg width="100" height="20" viewBox="0 0 100 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 10H40M60 10H80M50 5L50 15" stroke="currentColor" stroke-width="1" />
                                <circle cx="50" cy="10" r="3" stroke="currentColor" fill="none" />
                            </svg>
                        </div>
                        <div class="gin-name">von SchnakenGin</div>
                        <div class="divider decoration"></div>
                        <div class="ingredients">Wacholder, Orangenschale, Ingwer, Kardamom, Zitronengras, Malvenblüte</div>
                        <div class="flourish decoration">
                            <svg width="100" height="20" viewBox="0 0 100 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 10H40M60 10H80M50 5L50 15" stroke="currentColor" stroke-width="1" />
                                <circle cx="50" cy="10" r="3" stroke="currentColor" fill="none" />
                            </svg>
                        </div>
                        <div class="bottom-info">
                            <span class="amount"></span>
                            <span class="alcohol-content"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Declare variables first
            const textInputs = ['brandName','ginName','ingredients','alcoholContent','amount'];
            const fontSizeSliders = ['brandNameSize','ginNameSize','ingredientsSize','alcoholContentSize','amountSize'];
            const decorationLevelSlider = document.getElementById('decorationLevel');
            const decorationLevelValue = document.getElementById('decorationLevelValue');
            const blackAndWhiteToggle = document.getElementById('blackAndWhite');
            const paddingSlider = document.getElementById('padding');
            const paddingValue = document.getElementById('paddingValue');
            const colorControls = document.getElementById('colorControls');
            const backgroundColorInput = document.getElementById('backgroundColor');
            const primaryColorInput = document.getElementById('primaryColor');
            const secondaryColorInput = document.getElementById('secondaryColor');

            function adjustLayout() {
                // Stub to prevent errors
            }

            function idToClass(id) {
                return id.replace(/([A-Z])/g, '-$1').toLowerCase();
            }

            function updateLabel() {
                // Get all input values
                const brandName = document.getElementById('brandName').value;
                const ginName = document.getElementById('ginName').value;
                const ingredients = document.getElementById('ingredients').value;
                const alcoholContent = document.getElementById('alcoholContent').value;
                const amount = document.getElementById('amount').value;
                
                // Get font sizes
                const brandNameSize = document.getElementById('brandNameSize').value;
                const ginNameSize = document.getElementById('ginNameSize').value;
                const ingredientsSize = document.getElementById('ingredientsSize').value;
                const alcoholContentSize = document.getElementById('alcoholContentSize').value;
                const amountSize = document.getElementById('amountSize').value;
                
                // Update the preview
                document.querySelector('.brand-name').textContent = brandName;
                document.querySelector('.gin-name').textContent = ginName;
                document.querySelector('.ingredients').textContent = ingredients;
                document.querySelector('.alcohol-content').textContent = alcoholContent;
                document.querySelector('.amount').textContent = amount;
                
                // Update font sizes
                document.querySelector('.brand-name').style.fontSize = `${brandNameSize}px`;
                document.querySelector('.gin-name').style.fontSize = `${ginNameSize}px`;
                document.querySelector('.ingredients').style.fontSize = `${ingredientsSize}px`;
                document.querySelector('.alcohol-content').style.fontSize = `${alcoholContentSize}px`;
                document.querySelector('.amount').style.fontSize = `${amountSize}px`;
                
                // Get all flourish decorations
                const flourishElements = document.querySelectorAll('.flourish.decoration');
                
                // First flourish (between brand and gin name) - show only if both brand and gin name are present
                if (flourishElements[0]) {
                    if (brandName.trim() !== '' && ginName.trim() !== '') {
                        flourishElements[0].style.display = 'flex';
                    } else {
                        flourishElements[0].style.display = 'none';
                    }
                }
                
                // Second flourish (between ingredients and bottom info) - show only if both alcohol content and amount are present
                if (flourishElements[1]) {
                    if (alcoholContent.trim() !== '' && amount.trim() !== '') {
                        flourishElements[1].style.display = 'flex';
                    } else {
                        flourishElements[1].style.display = 'none';
                    }
                }
            }

            function updateDecorationLevel() {
                const level = parseInt(decorationLevelSlider.value);
                const label = document.querySelector('.label');
                
                // Update decoration class
                label.className = label.className.replace(/dec-level-\d+/, `dec-level-${level}`);
                
                // Show/hide decorative elements based on level
                const decorations = document.querySelectorAll('.decoration');
                decorations.forEach((el, index) => {
                    // Different elements appear at different levels
                    let thresholdLevel;
                    
                    if (el.classList.contains('inner-border')) {
                        thresholdLevel = 1;
                    } else if (el.classList.contains('divider')) {
                        thresholdLevel = 2;
                    } else if (el.classList.contains('corner')) {
                        thresholdLevel = 3;
                    } else if (el.classList.contains('flourish')) {
                        thresholdLevel = 4;
                    } else if (el.classList.contains('ornament')) {
                        thresholdLevel = 5;
                    } else if (el.classList.contains('double-border')) {
                        thresholdLevel = 6;
                    } else if (el.classList.contains('squiggle-top') || el.classList.contains('squiggle-bottom')) {
                        thresholdLevel = 7;
                    } else if (el.classList.contains('triple-border')) {
                        thresholdLevel = 8;
                    }
                    
                    if (level >= thresholdLevel) {
                        el.style.opacity = '1';
                    } else {
                        el.style.opacity = '0';
                    }
                });

                // Update squiggle content based on level
                const squiggleTop = document.querySelector('.squiggle-top');
                const squiggleBottom = document.querySelector('.squiggle-bottom');
                
                if (level >= 7) {
                    // Increase complexity with level
                    if (level === 7) {
                        squiggleTop.innerHTML = `
                            <svg width="100" height="10" viewBox="0 0 100 10" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 5C10 0 15 10 25 5C35 0 40 10 50 5C60 0 65 10 75 5C85 0 90 10 100 5" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                        squiggleBottom.innerHTML = `
                            <svg width="100" height="10" viewBox="0 0 100 10" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 5C10 0 15 10 25 5C35 0 40 10 50 5C60 0 65 10 75 5C85 0 90 10 100 5" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                    } else if (level === 8) {
                        squiggleTop.innerHTML = `
                            <svg width="120" height="10" viewBox="0 0 120 10" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 5L20 1L30 5L40 9L50 5L60 1L70 5L80 9L90 5L100 1L110 5" stroke="currentColor" fill="none" />
                                <circle cx="10" cy="5" r="2" stroke="currentColor" fill="none" />
                                <circle cx="50" cy="5" r="2" stroke="currentColor" fill="none" />
                                <circle cx="90" cy="5" r="2" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                        squiggleBottom.innerHTML = `
                            <svg width="120" height="10" viewBox="0 0 120 10" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 5L20 1L30 5L40 9L50 5L60 1L70 5L80 9L90 5L100 1L110 5" stroke="currentColor" fill="none" />
                                <circle cx="10" cy="5" r="2" stroke="currentColor" fill="none" />
                                <circle cx="50" cy="5" r="2" stroke="currentColor" fill="none" />
                                <circle cx="90" cy="5" r="2" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                    } else if (level === 9) {
                        squiggleTop.innerHTML = `
                            <svg width="150" height="15" viewBox="0 0 150 15" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 7.5C15 2.5 20 12.5 35 7.5C50 2.5 55 12.5 70 7.5C85 2.5 90 12.5 105 7.5C120 2.5 125 12.5 140 7.5" stroke="currentColor" fill="none" />
                                <path d="M25 7.5L35 2.5L45 7.5" stroke="currentColor" fill="none" />
                                <path d="M95 7.5L105 2.5L115 7.5" stroke="currentColor" fill="none" />
                                <circle cx="75" cy="7.5" r="3" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                        squiggleBottom.innerHTML = `
                            <svg width="150" height="15" viewBox="0 0 150 15" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 7.5C15 2.5 20 12.5 35 7.5C50 2.5 55 12.5 70 7.5C85 2.5 90 12.5 105 7.5C120 2.5 125 12.5 140 7.5" stroke="currentColor" fill="none" />
                                <path d="M25 7.5L35 2.5L45 7.5" stroke="currentColor" fill="none" />
                                <path d="M95 7.5L105 2.5L115 7.5" stroke="currentColor" fill="none" />
                                <circle cx="75" cy="7.5" r="3" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                    } else if (level === 10) {
                        squiggleTop.innerHTML = `
                            <svg width="180" height="20" viewBox="0 0 180 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 10C15 5 20 15 35 10C50 5 55 15 70 10C85 5 90 15 105 10C120 5 125 15 140 10C155 5 160 15 175 10" stroke="currentColor" fill="none" />
                                <path d="M20 10L30 5L40 10" stroke="currentColor" fill="none" />
                                <path d="M80 10L90 5L100 10" stroke="currentColor" fill="none" />
                                <path d="M140 10L150 5L160 10" stroke="currentColor" fill="none" />
                                <circle cx="60" cy="10" r="3" stroke="currentColor" fill="none" />
                                <circle cx="120" cy="10" r="3" stroke="currentColor" fill="none" />
                                <path d="M45 15L55 5" stroke="currentColor" fill="none" />
                                <path d="M105 15L115 5" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                        squiggleBottom.innerHTML = `
                            <svg width="180" height="20" viewBox="0 0 180 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 10C15 5 20 15 35 10C50 5 55 15 70 10C85 5 90 15 105 10C120 5 125 15 140 10C155 5 160 15 175 10" stroke="currentColor" fill="none" />
                                <path d="M20 10L30 5L40 10" stroke="currentColor" fill="none" />
                                <path d="M80 10L90 5L100 10" stroke="currentColor" fill="none" />
                                <path d="M140 10L150 5L160 10" stroke="currentColor" fill="none" />
                                <circle cx="60" cy="10" r="3" stroke="currentColor" fill="none" />
                                <circle cx="120" cy="10" r="3" stroke="currentColor" fill="none" />
                                <path d="M45 15L55 5" stroke="currentColor" fill="none" />
                                <path d="M105 15L115 5" stroke="currentColor" fill="none" />
                            </svg>
                        `;
                    }
                }
            }

            function saveAsPNG() {
                html2canvas(document.querySelector('.label-preview')).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'label.png';
                    link.href = canvas.toDataURL();
                    link.click();
                });
            }

            // Save all user input to localStorage
            function saveToLocalStorage() {
                // Save text inputs
                textInputs.forEach(id => {
                    const element = document.getElementById(id);
                    localStorage.setItem(id, element.value);
                });
                
                // Save font size sliders
                fontSizeSliders.forEach(id => {
                    const slider = document.getElementById(id);
                    localStorage.setItem(id, slider.value);
                });
                
                // Save decoration level
                localStorage.setItem('decorationLevel', decorationLevelSlider.value);
                
                // Save padding
                localStorage.setItem('padding', paddingSlider.value);
                
                // Save color mode
                localStorage.setItem('blackAndWhite', blackAndWhiteToggle.checked);
                
                // Save color inputs
                localStorage.setItem('backgroundColor', backgroundColorInput.value);
                localStorage.setItem('primaryColor', primaryColorInput.value);
                localStorage.setItem('secondaryColor', secondaryColorInput.value);
            }
            
            // Load saved values from localStorage
            function loadFromLocalStorage() {
                // Load text inputs
                textInputs.forEach(id => {
                    const savedValue = localStorage.getItem(id);
                    if (savedValue) {
                        document.getElementById(id).value = savedValue;
                    }
                });
                
                // Load font size sliders
                fontSizeSliders.forEach(id => {
                    const savedValue = localStorage.getItem(id);
                    if (savedValue) {
                        const slider = document.getElementById(id);
                        slider.value = savedValue;
                    }
                });
                
                // Load decoration level
                const savedDecorationLevel = localStorage.getItem('decorationLevel');
                if (savedDecorationLevel) {
                    decorationLevelSlider.value = savedDecorationLevel;
                    decorationLevelValue.textContent = savedDecorationLevel;
                    document.documentElement.style.setProperty('--decoration-level', savedDecorationLevel);
                }
                
                // Load padding
                const savedPadding = localStorage.getItem('padding');
                if (savedPadding) {
                    paddingSlider.value = savedPadding;
                    paddingValue.textContent = `${savedPadding}px`;
                    document.documentElement.style.setProperty('--padding', savedPadding);
                }
                
                // Load color mode and colors
                const savedBlackAndWhite = localStorage.getItem('blackAndWhite');
                const colorControls = document.getElementById('colorControls');
                
                // Load saved colors
                const savedBgColor = localStorage.getItem('backgroundColor') || '#F6F0ED';
                const savedPrimaryColor = localStorage.getItem('primaryColor') || '#28536B';
                const savedSecondaryColor = localStorage.getItem('secondaryColor') || '#7EA8BE';
                
                document.getElementById('backgroundColor').value = savedBgColor;
                document.getElementById('primaryColor').value = savedPrimaryColor;
                document.getElementById('secondaryColor').value = savedSecondaryColor;
                
                if (savedBlackAndWhite !== null) {
                    blackAndWhiteToggle.checked = savedBlackAndWhite === 'true';
                    if (blackAndWhiteToggle.checked) {
                        // Black & White mode
                        document.documentElement.style.setProperty('--main-color', '#000');
                        document.documentElement.style.setProperty('--secondary-color', '#555555');
                        document.documentElement.style.setProperty('--background-color', '#fff');
                        colorControls.style.display = 'none';
                    } else {
                        // Color mode
                        document.documentElement.style.setProperty('--main-color', savedPrimaryColor);
                        document.documentElement.style.setProperty('--secondary-color', savedSecondaryColor);
                        document.documentElement.style.setProperty('--background-color', savedBgColor);
                        colorControls.style.display = 'block';
                    }
                }
            }
            
            // Clear all saved data and reset to defaults
            function resetAll() {
                // Clear localStorage
                localStorage.clear();
                
                // Reset text inputs
                textInputs.forEach(id => {
                    document.getElementById(id).value = '';
                });
                
                // Reset font size sliders to default values
                document.getElementById('brandNameSize').value = 24;
                document.getElementById('brandNameSizeValue').textContent = '24px';
                document.getElementById('ginNameSize').value = 36;
                document.getElementById('ginNameSizeValue').textContent = '36px';
                document.getElementById('ingredientsSize').value = 12;
                document.getElementById('ingredientsSizeValue').textContent = '12px';
                document.getElementById('alcoholContentSize').value = 14;
                document.getElementById('alcoholContentSizeValue').textContent = '14px';
                document.getElementById('amountSize').value = 14;
                document.getElementById('amountSizeValue').textContent = '14px';
                
                // Reset decoration level
                decorationLevelSlider.value = 5;
                decorationLevelValue.textContent = '5';
                document.documentElement.style.setProperty('--decoration-level', 5);
                
                // Reset padding
                paddingSlider.value = 40;
                paddingValue.textContent = '40px';
                document.documentElement.style.setProperty('--padding', 40);
                
                // Reset color mode
                blackAndWhiteToggle.checked = true;
                document.documentElement.style.setProperty('--main-color', '#000');
                document.documentElement.style.setProperty('--secondary-color', '#555555');
                document.documentElement.style.setProperty('--background-color', '#fff');
                document.getElementById('colorControls').style.display = 'none';
                
                // Reset color inputs to default values
                document.getElementById('backgroundColor').value = '#F6F0ED';
                document.getElementById('primaryColor').value = '#28536B';
                document.getElementById('secondaryColor').value = '#7EA8BE';
                
                // Update the label with reset values
                updateLabel();
                updateDecorationLevel();
            }

            // Debounce function to limit how often a function is called
            function debounce(func, wait) {
                let timeout;
                return function() {
                    const context = this;
                    const args = arguments;
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        func.apply(context, args);
                    }, wait);
                };
            }
            
            // Use requestAnimationFrame for smooth UI updates
            function rafDebounce(func) {
                let rafId = null;
                return function() {
                    const context = this;
                    const args = arguments;
                    if (rafId) {
                        cancelAnimationFrame(rafId);
                    }
                    rafId = requestAnimationFrame(() => {
                        func.apply(context, args);
                        rafId = null;
                    });
                };
            }
            
            // Create optimized versions of heavy functions
            const debouncedUpdateLabel = rafDebounce(updateLabel);
            const debouncedSaveToLocalStorage = debounce(saveToLocalStorage, 500);
            const debouncedUpdateDecorationLevel = rafDebounce(updateDecorationLevel);
            
            // Set up text input listeners
            textInputs.forEach(id => {
                document.getElementById(id).addEventListener('input', () => {
                    debouncedUpdateLabel();
                    debouncedSaveToLocalStorage();
                });
            });
            
            // Font size slider event listeners with improved performance
            fontSizeSliders.forEach(id => {
                const slider = document.getElementById(id);
                const valueSpan = document.getElementById(`${id}Value`);
                
                // Use input event for real-time updates
                slider.addEventListener('input', function() {
                    // Update the value display immediately
                    valueSpan.textContent = `${this.value}px`;
                    
                    // Update the corresponding element's font size directly for immediate feedback
                    const className = idToClass(id.replace('Size', ''));
                    const targetEl = document.querySelector(`.${className}`);
                    if (targetEl) {
                        targetEl.style.fontSize = `${this.value}px`;
                    }
                    
                    // Use requestAnimationFrame for the heavier operations
                    debouncedUpdateLabel();
                    debouncedSaveToLocalStorage();
                });
            });

            // Decoration level slider with improved performance
            decorationLevelSlider.addEventListener('input', function() {
                // Update the value display immediately
                decorationLevelValue.textContent = this.value;
                
                // Set the CSS property immediately
                document.documentElement.style.setProperty('--decoration-level', this.value);
                
                // Use optimized functions for heavier operations
                debouncedUpdateDecorationLevel();
                debouncedSaveToLocalStorage();
            });

            // Padding slider with improved performance
            paddingSlider.addEventListener('input', function() {
                // Update the value display immediately
                paddingValue.textContent = `${this.value}px`;
                
                // Set the CSS property immediately
                document.documentElement.style.setProperty('--padding', this.value);
                
                // Use optimized functions for heavier operations
                debouncedUpdateLabel();
                debouncedSaveToLocalStorage();
            });

            blackAndWhiteToggle.addEventListener('change', () => {
                const colorControls = document.getElementById('colorControls');
                
                if (blackAndWhiteToggle.checked) {
                    // Black & White mode
                    document.documentElement.style.setProperty('--main-color', '#000');
                    document.documentElement.style.setProperty('--secondary-color', '#555555');
                    document.documentElement.style.setProperty('--background-color', '#fff');
                    colorControls.style.display = 'none';
                } else {
                    // Color mode
                    const primaryColor = document.getElementById('primaryColor').value;
                    const secondaryColor = document.getElementById('secondaryColor').value;
                    const bgColor = document.getElementById('backgroundColor').value;
                    
                    document.documentElement.style.setProperty('--main-color', primaryColor);
                    document.documentElement.style.setProperty('--secondary-color', secondaryColor);
                    document.documentElement.style.setProperty('--background-color', bgColor);
                    colorControls.style.display = 'block';
                }
                
                saveToLocalStorage();
            });

            // Color input event listeners
            document.getElementById('backgroundColor').addEventListener('input', function() {
                document.documentElement.style.setProperty('--background-color', this.value);
                saveToLocalStorage();
            });
            
            document.getElementById('primaryColor').addEventListener('input', function() {
                document.documentElement.style.setProperty('--main-color', this.value);
                saveToLocalStorage();
            });
            
            document.getElementById('secondaryColor').addEventListener('input', function() {
                document.documentElement.style.setProperty('--secondary-color', this.value);
                saveToLocalStorage();
            });

            document.getElementById('saveButton').addEventListener('click', saveAsPNG);

            document.getElementById('clearButton').addEventListener('click', resetAll);

            // Initial calls
            loadFromLocalStorage(); // Load saved data first
            updateLabel();
            updateDecorationLevel();
            
            // Initialize padding value on page load
            document.documentElement.style.setProperty('--padding', paddingSlider.value);
            paddingValue.textContent = `${paddingSlider.value}px`;
        });
    </script>
</body>
</html>
